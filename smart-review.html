<!DOCTYPE html>
<html lang="en" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Bootstrap Css -->
    <link href="assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
    <!-- Icons Css -->
    <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="assets/css/app-rtl.min.css" id="app-style" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/rating.css">
    <style>
        .custom-img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            position: absolute;
            transform: translateX(-50%);
            border: 2px solid #007bff;
            z-index: 10;
        }

        #technicians-chart {
            position: relative;
        }
    </style>

    <!-- apexcharts -->
    <script src="assets/libs/apexcharts/apexcharts.min.js"></script>
</head>

<body>

    <div id="layout-wrapper">

        <header id="page-topbar">
            <div class="navbar-header">
                <div class="d-flex">
                    <!-- LOGO -->
                    <div class="navbar-brand-box">
                        <a href="index.html" class="logo d-flex align-items-center justify-content-center gap-4">

                            <span class="logo-lg ">
                                <img src="assets/images/brands/Simplification.png" alt="" height="32"
                                    class="mb-2">

                            </span>
                            <div>
                                <h3>لوحة التحكم</h3>
                            </div>
                        </a>


                    </div>

                    <button type="button" class="btn btn-sm px-3 font-size-16 header-item waves-effect"
                        id="vertical-menu-btn">
                        <i class="fa fa-fw fa-bars"></i>
                    </button>
                </div>
                <!-- App Search-->
                <form class="app-search d-none d-lg-block flex-grow-1">
                    <div class="position-relative">
                        <input type="text" class="form-control" placeholder="بحث"
                            style="background-color: white; border-radius: 2px; border: 1px solid rgb(224, 223, 223);">
                        <span class="bx bx-search-alt"></span>
                    </div>
                </form>

                <div class="d-flex">
                    <div class="dropdown d-inline-block d-lg-none ms-2">
                        <button type="button" class="btn header-item noti-icon waves-effect"
                            id="page-header-search-dropdown" data-bs-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            <i class="mdi mdi-magnify"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0"
                            aria-labelledby="page-header-search-dropdown">

                            <form class="p-3">
                                <div class="form-group m-0">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Search ..."
                                            aria-label="Recipient's username">
                                        <div class="input-group-append">
                                            <button class="btn btn-primary" type="submit"><i
                                                    class="mdi mdi-magnify"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="dropdown d-inline-block">
                        <button type="button" class="btn header-item noti-icon waves-effect"
                            id="page-header-notifications-dropdown" data-bs-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            <i class="bx bx-bell bx-tada"></i>
                            <span class="badge bg-danger rounded-pill">3</span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-lg  p-0"
                            aria-labelledby="page-header-notifications-dropdown">
                            <div class="p-3">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <h6 class="m-0" key="t-notifications"> اشعارات </h6>
                                    </div>
                                    <div class="col-auto">
                                        <a href="#!" class="small" key="t-view-all"> عرض الكل</a>
                                    </div>
                                </div>
                            </div>
                            <div data-simplebar style="max-height: 230px;">
                                <a href="#" class="text-reset notification-item">
                                    <div class="media">
                                        <div class="avatar-xs me-3">
                                            <span class="avatar-title bg-success rounded-circle font-size-16">
                                                <i class="bx bx-badge-check"></i>
                                            </span>
                                        </div>
                                        <div class="media-body">
                                            <h6 class="mt-0 mb-1" key="t-your-order">الفنى قادم اليك</h6>
                                            <div class="font-size-12 text-muted">
                                                <p class="mb-1" key="t-grammer">يمكنك التواصل معه </p>
                                                <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span
                                                        key="t-min-ago">من 3 دقائق</span></p>
                                            </div>
                                        </div>
                                    </div>
                                </a>

                                <a href="#" class="text-reset notification-item">
                                    <div class="media">
                                        <div class="avatar-xs me-3">
                                            <span class="avatar-title bg-success rounded-circle font-size-16">
                                                <i class="bx bx-badge-check"></i>
                                            </span>
                                        </div>
                                        <div class="media-body">
                                            <h6 class="mt-0 mb-1">يوجد فنيين فى تخصصات جديدة</h6>
                                            <div class="font-size-12 text-muted">

                                                <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span
                                                        key="t-hours-ago">من 1 ساعة</span></p>
                                            </div>
                                        </div>
                                    </div>
                                </a>

                                <a href="#" class="text-reset notification-item">
                                    <div class="media">
                                        <div class="avatar-xs me-3">
                                            <span class="avatar-title bg-success rounded-circle font-size-16">
                                                <i class="bx bx-badge-check"></i>
                                            </span>
                                        </div>
                                        <div class="media-body">
                                            <h6 class="mt-0 mb-1">يوجد فنيين فى تخصصات جديدة</h6>
                                            <div class="font-size-12 text-muted">

                                                <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span
                                                        key="t-hours-ago">من 1 ساعة</span></p>
                                            </div>
                                        </div>
                                    </div>
                                </a>

                            </div>
                            <div class="p-2 border-top d-grid">
                                <a class="btn btn-sm btn-link font-size-14 text-center" href="javascript:void(0)">
                                    <i class="mdi mdi-arrow-right-circle me-1"></i> <span key="t-view-more">
                                        عرض الكل</span>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="dropdown d-inline-block">
                        <button type="button" class="btn header-item waves-effect" id="page-header-user-dropdown"
                            data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="mdi mdi-chevron-down d-none d-xl-inline-block "></i>
                            <img class="rounded-circle header-profile-user "
                                src="assets/images/users/avatar-1.jpg" alt="Header Avatar">
                            <span class="d-none d-xl-inline-block ms-1" key="t-henry"></span>

                        </button>
                        <div class="dropdown-menu ">
                            <!-- item-->
                            <a class="dropdown-item" href="#"><i class="bx bx-user font-size-16 align-middle me-1"></i>
                                <span key="t-profile">ملف شخصى</span></a>


                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#"><i
                                    class="bx bx-power-off font-size-16 align-middle me-1 text-danger"></i> <span
                                    key="t-logout"> تسجيل الخروج</span></a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- ========== Left Sidebar Start ========== -->
        <div class="vertical-menu">

            <div data-simplebar class="h-100">


                <div id="sidebar-menu" class="h-100">

                    <ul class="metismenu list-unstyled" id="side-menu">
                        <li>
                            <a href="/handyman-dashboard/index.html" class="waves-effect">
                                <i class="bx bx-home-circle"></i>
                                <span key="t-dashboards">الصفحه الرئيسية</span>
                            </a>
                        </li>

                        <li>
                            <a href="/handyman-dashboard/orderManagement.html" class="waves-effect">
                                <i class="bx bx-file"></i>
                                <span key="t-layouts">إدارة الطلبات</span>
                            </a>
                        </li>
                        <li>
                            <a href="/handyman-dashboard/techManagement.html" class="waves-effect">
                                <i class="bx bx-user"></i>
                                <span key="t-layouts">إدارة الفنيين</span>
                            </a>
                        </li>
                        <li>
                            <a href="/handyman-dashboard/customers.html" class="waves-effect">
                                <i class="bx bx-group"></i>
                                <span key="t-layouts">إدارة العملاء </span>
                            </a>
                        </li>
                        <li>
                            <a href="/handyman-dashboard/liveMap.html" class="waves-effect">
                                <i class="bx bx-map"></i>
                                <span key="t-layouts">نظام التتبع المباشر </span>
                            </a>
                        </li>
                        <li>
                            <a href="/handyman-dashboard/chat.html" class="waves-effect">
                                <i class="bx bx-chat"></i>
                                <span key="t-layouts"> نظام الدردشة الفورية</span>
                            </a>
                        </li>
                        <li>
                            <a href="/handyman-dashboard/paymentManagment.html" class="waves-effect">
                                <i class="bx bx-wallet"></i>
                                <span key="t-layouts"> إدارة المدفوعات</span>
                            </a>
                        </li>
                        <li>
                            <a href="/handyman-dashboard/mainManagement.html" class="waves-effect">
                                <i class="bx bx-cog"></i>
                                <span key="t-layouts"> الإعدادات العامة</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="bx bx-bar-chart"></i>
                                <span key="t-layouts"> التقارير والتحليلات</span>
                            </a>
                        </li>
                        <li>
                            <a href="/handyman-dashboard/smart-review.html" class="waves-effect">
                                <i class="bx bx-check-shield"></i>
                                <span key="t-layouts"> نظام المراجعة الذكي</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="bx bx-support"></i>
                                <span key="t-layouts"> مركز الدعم الفني</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="bx bx-analyse"></i>
                                <span key="t-layouts"> الذكاء الاصطناعي لتحليل البيانات</span>
                            </a>
                        </li>
<!-- 
                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="bx bx-trophy"></i>
                                <span key="t-layouts"> نظام تحفيز الفنيين</span>
                            </a>
                        </li> -->
                    </ul>
                    <ul class="metismenu list-unstyled mt-6">
                        <li>
                            <a  href="/handyman-dashboard/login.html" class=" waves-effect">
                                <i class="bx bx-log-out fw-bolder"></i>
                                <span key="t-layouts fw-bolder"> تسجيل الخروج</span>
                            </a>

                        </li>
                    </ul>
                </div>

            </div>
        </div>
        <!-- Left Sidebar End -->

        <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content" style="background-color: white;">

            <div class="page-content rating">
                <div class="container-fluid">
                    <div class="row">
                        <!-- Top Rated Technicians -->
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <h4 class="card-title mb-0">الفنيين المتميزين</h4>
                                        <div class="dropdown">
                                            <button
                                                class="btn dropdown-toggle d-flex align-items-center gap-2 text-primary"
                                                type="button" id="timeFilterDropdown" data-bs-toggle="dropdown"
                                                aria-expanded="false">
                                                <span class="text fw-bold">شهري</span>
                                                <i class="bx bx-chevron-down"></i>
                                            </button>
                                            <ul class="dropdown-menu" aria-labelledby="timeFilterDropdown">
                                                <li><a class="dropdown-item" href="#" data-filter="monthly">شهري</a>
                                                </li>
                                                <li><a class="dropdown-item" href="#" data-filter="yearly">سنوي</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div id="technicians-chart" style="height: 300px; margin-top: 60px;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Rating Statistics -->
                        <div class="col-md-6">
                            <div class="card h-100 rating-statistics">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <h4 class="card-title mb-0">التقييمات</h4>
                                        <div class="d-flex gap-2">
                                            <div class="dropdown">
                                                <button
                                                    class="btn dropdown-toggle d-flex align-items-center gap-2 text-primary"
                                                    type="button" id="areaFilterDropdown" data-bs-toggle="dropdown"
                                                    aria-expanded="false">
                                                    <span class="text fw-bold">المنطقة</span>
                                                    <i class="bx bx-chevron-down"></i>
                                                </button>
                                                <ul class="dropdown-menu" aria-labelledby="areaFilterDropdown">
                                                    <li><a class="dropdown-item" href="#" data-area="all">كل المناطق</a>
                                                    </li>
                                                    <li><a class="dropdown-item" href="#" data-area="riyadh">الرياض</a>
                                                    </li>
                                                    <li><a class="dropdown-item" href="#" data-area="jeddah">جدة</a>
                                                    </li>
                                                    <li><a class="dropdown-item" href="#" data-area="dammam">الدمام</a>
                                                    </li>
                                                </ul>
                                            </div>
                                            <div class="dropdown">
                                                <button
                                                    class="btn dropdown-toggle d-flex align-items-center gap-2 text-primary"
                                                    type="button" id="handymanFilterDropdown" data-bs-toggle="dropdown"
                                                    aria-expanded="false">
                                                    <span class="text fw-bold">الفني</span>
                                                    <i class="bx bx-chevron-down"></i>
                                                </button>
                                                <ul class="dropdown-menu" aria-labelledby="handymanFilterDropdown">
                                                    <li><a class="dropdown-item" href="#" data-handyman="all">كل
                                                            الفنيين</a></li>
                                                    <li><a class="dropdown-item" href="#"
                                                            data-handyman="plumber">السباكة</a></li>
                                                    <li><a class="dropdown-item" href="#"
                                                            data-handyman="electrician">الكهرباء</a></li>
                                                    <li><a class="dropdown-item" href="#"
                                                            data-handyman="carpenter">النجارة</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <div class="ms-2 d-flex align-items-center">
                                            <span class="mdi mdi-account-multiple-outline fs-3 text-primary"></span>
                                            <span class="fw-bold fs-4 me-2">100</span>
                                        </div>
                                        <div class="progress flex-grow-1">
                                            <div class="progress-bar" style="width: 100%;"></div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                                stroke="gold" stroke-width="2" class="bi bi-star-fill"
                                                viewBox="0 0 16 16">
                                                <path
                                                    d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                                            </svg>
                                            <span class="me-2 fs-4 fw-bold">5</span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <div class="ms-2 d-flex align-items-center">
                                            <span class="mdi mdi-account-multiple-outline fs-3 text-primary"></span>
                                            <span class="fw-bold fs-4 me-2">66</span>
                                        </div>
                                        <div class="progress flex-grow-1">
                                            <div class="progress-bar" style="width: 66%;"></div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                                stroke="gold" stroke-width="2" class="bi bi-star-fill"
                                                viewBox="0 0 16 16">
                                                <path
                                                    d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                                            </svg>
                                            <span class="me-2 fs-4 fw-bold">4</span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <div class="ms-2 d-flex align-items-center">
                                            <span class="mdi mdi-account-multiple-outline fs-3 text-primary"></span>
                                            <span class="fw-bold fs-4 me-2">88</span>
                                        </div>
                                        <div class="progress flex-grow-1">
                                            <div class="progress-bar" style="width: 88%;"></div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                                stroke="gold" stroke-width="2" class="bi bi-star-fill"
                                                viewBox="0 0 16 16">
                                                <path
                                                    d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                                            </svg>
                                            <span class="me-2 fs-4 fw-bold">3</span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <div class="ms-2 d-flex align-items-center">
                                            <span class="mdi mdi-account-multiple-outline fs-3 text-primary"></span>
                                            <span class="fw-bold fs-4 me-2">20</span>
                                        </div>
                                        <div class="progress flex-grow-1">
                                            <div class="progress-bar" style="width: 20%;"></div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                                stroke="gold" stroke-width="2" class="bi bi-star-fill"
                                                viewBox="0 0 16 16">
                                                <path
                                                    d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                                            </svg>
                                            <span class="me-2 fs-4 fw-bold">2</span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <div class="ms-2 d-flex align-items-center">
                                            <span class="mdi mdi-account-multiple-outline fs-3 text-primary"></span>
                                            <span class="fw-bold fs-4 me-2">10</span>
                                        </div>
                                        <div class="progress flex-grow-1">
                                            <div class="progress-bar" style="width: 10%;"></div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none"
                                                stroke="gold" stroke-width="2" class="bi bi-star-fill"
                                                viewBox="0 0 16 16">
                                                <path
                                                    d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                                            </svg>
                                            <span class="me-2 fs-4 fw-bold">1</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- container-fluid -->
    <!-- End Page-content -->

    <script src="assets/libs/jquery/jquery.min.js"></script>
    <script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/libs/metismenu/metisMenu.min.js"></script>
    <script src="assets/libs/simplebar/simplebar.min.js"></script>
    <script src="assets/libs/node-waves/waves.min.js"></script>

    <script src="assets/js/app.js"></script>
    <script src="assets/js/main.js"></script>

    <!-- Initialize the chart after the DOM is loaded -->
    <script>
        window.onload = function () {
            var options = {
                chart: {
                    type: 'bar',
                    height: 300,
                    events: {
                        mounted: function (chartContext, config) {
                            // Add images after the chart is mounted
                            const images = [
                                'assets/images/users/avatar-1.jpg',
                                'assets/images/users/avatar-2.jpg',
                                'assets/images/users/avatar-3.jpg',
                                'assets/images/users/avatar-4.jpg',
                                'assets/images/users/avatar-5.jpg'
                            ];

                            const bars = document.querySelectorAll(".apexcharts-bar-area .apexcharts-bar-series .apexcharts-bar");

                            bars.forEach((bar, index) => {
                                const rect = bar.getBoundingClientRect();
                                const chartContainer = document.querySelector("#technicians-chart");

                                const img = document.createElement("img");
                                img.src = images[index];
                                img.className = "custom-img";
                                img.style.top = (rect.top - chartContainer.getBoundingClientRect().top - 55) + "px";
                                img.style.left = (rect.left - chartContainer.getBoundingClientRect().left + rect.width / 2) + "px";

                                chartContainer.appendChild(img);
                            });
                        }
                    }
                },
                series: [{
                    name: 'Performance',
                    data: [40, 60, 75, 85, 100]
                }],
                xaxis: {
                    categories: ['فني 1', 'فني 2', 'فني 3', 'فني 4', 'فني 5']
                },
                colors: ['#007bff'],
                plotOptions: {
                    bar: {
                        horizontal: false,
                        columnWidth: '50%',
                        endingShape: 'rounded'
                    }
                },
                dataLabels: {
                    enabled: false
                }
            };

            var chart = new ApexCharts(document.querySelector("#technicians-chart"), options);
            chart.render();
        };
    </script>

    <!-- Update the JavaScript -->
    <script>
        window.onload = function () {
            var options = {
                chart: {
                    type: 'bar',
                    height: 300,
                    events: {
                        mounted: function (chartContext, config) {
                            setTimeout(() => {
                                const images = [
                                    'assets/images/users/avatar-1.jpg',
                                    'assets/images/users/avatar-2.jpg',
                                    'assets/images/users/avatar-3.jpg',
                                    'assets/images/users/avatar-4.jpg',
                                    'assets/images/users/avatar-5.jpg'
                                ];

                                const bars = document.querySelectorAll("#technicians-chart .apexcharts-bar-series path");
                                const chartContainer = document.querySelector("#technicians-chart");

                                // Remove existing images if any
                                const existingImages = chartContainer.querySelectorAll('.custom-img');
                                existingImages.forEach(img => img.remove());

                                bars.forEach((bar, index) => {
                                    const rect = bar.getBoundingClientRect();
                                    const chartRect = chartContainer.getBoundingClientRect();
                                    const percentage = config.config.series[0].data[index];

                                    // const verticalOffset = (100 - percentage) * 2;
                                    console.log(rect.top, chartRect.top, percentage);
                                    console.log(config);


                                    const img = document.createElement("img");
                                    img.src = images[index];
                                    img.className = "custom-img";
                                    // img.style.top = (rect.top - chartRect.top - (percentage > 75 ? percentage * 0.9 : percentage * 0.5)) + "px";
                                    // img.style.top = (rect.top - chartRect.top - percentage) + "px";
                                    img.style.top = "0px";
                                    img.style.left = (rect.left - chartRect.left + (rect.width / 2)) + "px";

                                    chartContainer.appendChild(img);
                                });
                            }, 500); // Add delay to ensure chart is fully rendered
                        }
                    }
                },
                series: [{
                    name: 'التقييم',
                    data: [40, 60, 75, 85, 100]
                }],
                xaxis: {
                    categories: ['فني 1', 'فني 2', 'فني 3', 'فني 4', 'فني 5'],
                    labels: {
                        style: {
                            fontSize: '12px'
                        }
                    }
                },
                colors: ['#556ee6'],
                plotOptions: {
                    bar: {
                        horizontal: false,
                        columnWidth: '45%',
                        borderRadius: 5,
                        endingShape: 'rounded'
                    }
                },
                dataLabels: {
                    enabled: true,
                    formatter: function (val) {
                        return val + "%"
                    },
                    offsetY: -20,
                    style: {
                        fontSize: '12px',
                        colors: ["#304758"]
                    }
                },
            };

            var chart = new ApexCharts(document.querySelector("#technicians-chart"), options);
            chart.render();

            function updateImages() {
                setTimeout(() => {
                    const images = [
                        'assets/images/users/avatar-1.jpg',
                        'assets/images/users/avatar-2.jpg',
                        'assets/images/users/avatar-3.jpg',
                        'assets/images/users/avatar-4.jpg',
                        'assets/images/users/avatar-5.jpg'
                    ];

                    const bars = document.querySelectorAll("#technicians-chart .apexcharts-bar-series path");
                    const chartContainer = document.querySelector("#technicians-chart");

                    // Remove existing images
                    const existingImages = chartContainer.querySelectorAll('.custom-img');
                    existingImages.forEach(img => img.remove());

                    bars.forEach((bar, index) => {
                        const rect = bar.getBoundingClientRect();
                        const chartRect = chartContainer.getBoundingClientRect();

                        const img = document.createElement("img");
                        img.src = images[index];
                        img.className = "custom-img";
                        img.style.top = "0px";
                        img.style.left = (rect.left - chartRect.left + (rect.width / 2)) + "px";

                        chartContainer.appendChild(img);
                    });
                }, 500);
            }

            // Add event listener for chart update
            chart.addEventListener('updated', updateImages);

            // Filter click handler
            document.querySelectorAll('[data-filter]').forEach(item => {
                item.addEventListener('click', function (e) {
                    e.preventDefault();
                    const filterType = this.dataset.filter;
                    document.querySelector('#timeFilterDropdown .text').textContent = filterType === 'monthly' ? 'شهري' : 'سنوي';
                    const newData = filterType === 'monthly' ?
                        [40, 60, 75, 85, 100] :
                        [65, 78, 82, 91, 95];

                    chart.updateSeries([{
                        name: 'التقييم',
                        data: newData
                    }]);
                });
            });
        };
    </script>
</body>

</html>